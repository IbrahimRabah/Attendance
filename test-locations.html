<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Locations</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.rtl.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h2>Location System Test</h2>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5>Current Locations in localStorage</h5>
            </div>
            <div class="card-body">
                <div id="locationsDisplay"></div>
                <button class="btn btn-primary mt-3" onclick="initializeLocations()">Initialize Default Locations</button>
                <button class="btn btn-success mt-3" onclick="loadLocations()">Reload Locations</button>
            </div>
        </div>
        
        <div class="card mt-4">
            <div class="card-header">
                <h5>Test Location Dropdown</h5>
            </div>
            <div class="card-body">
                <select class="form-control" id="testLocationSelect">
                    <option value="">اختر الموقع</option>
                </select>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        function loadLocations() {
            // Get locations from localStorage (using the same format as main app)
            const locations = JSON.parse(localStorage.getItem('attendanceLocations')) || [];
            
            const display = document.getElementById('locationsDisplay');
            const select = document.getElementById('testLocationSelect');
            
            // Clear previous content
            display.innerHTML = '';
            select.innerHTML = '<option value="">اختر الموقع</option>';
            
            if (locations.length === 0) {
                display.innerHTML = '<div class="alert alert-warning">No locations found in localStorage</div>';
                return;
            }
            
            display.innerHTML = '<div class="alert alert-success">Found ' + locations.length + ' locations:</div>';
            
            locations.forEach(location => {
                const locationDiv = document.createElement('div');
                locationDiv.innerHTML = `<strong>ID:</strong> ${location.id}, <strong>Name:</strong> ${location.name}`;
                display.appendChild(locationDiv);
                
                // Add to select
                const option = document.createElement('option');
                option.value = location.name;
                option.textContent = location.name;
                select.appendChild(option);
            });
        }
        
        function initializeLocations() {
            // Initialize with default location if none exist
            const locations = JSON.parse(localStorage.getItem('attendanceLocations')) || [];
            
            if (locations.length === 0) {
                const defaultLocation = { id: 1, name: 'المكتب الرئيسي' };
                localStorage.setItem('attendanceLocations', JSON.stringify([defaultLocation]));
                alert('Default location initialized!');
            } else {
                alert('Locations already exist!');
            }
            
            loadLocations();
        }
        
        // Load locations on page load
        document.addEventListener('DOMContentLoaded', loadLocations);
    </script>
</body>
</html>